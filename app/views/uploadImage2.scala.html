<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>@common.title()</title>

		<meta name="description" content="jcoa" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		@common.bootstrapcss()
    
		<!-- inline styles related to this page -->
		@common.bootstrapjs()
		<script src="@routes.Assets.at("source/ajaxupload.js")"></script>
		<!--引入CSS-->
		<link rel="stylesheet" type="text/css" href="@routes.Assets.at("webuploader-0.1.5/webuploader.css")">
		
		<!--引入JS-->
		<script type="text/javascript" src="@routes.Assets.at("webuploader-0.1.5/webuploader.js")"></script>
		
		<!--引入CSS-->
		<link rel="stylesheet" type="text/css" href="@routes.Assets.at("webuploader-0.1.5/demo.css")">
		
		<!--引入JS
		<script type="text/javascript" src="@routes.Assets.at("webuploader-0.1.5/demo.js")"></script>-->
		
		<!--SWF在初始化的时候指定，在后面将展示-->
				
	</head>

	<body class="no-skin">
		<!-- #section:basics/navbar.layout -->

		<!-- /section:basics/navbar.layout -->
		<div class="main-container" id="main-container">
			<script type="text/javascript">
				try{ace.settings.check('main-container' , 'fixed')}catch(e){}
			</script>

			<!-- #section:basics/sidebar left-->

			<!-- /section:basics/sidebar -->
			<div class="main-content">
				<div class="main-content-inner">
					<!-- #section:basics/content.breadcrumbs -->
					<div class="breadcrumbs" id="breadcrumbs">
						<script type="text/javascript">
							try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
						</script>

						<ul class="breadcrumb">
							<li>
								<i class="ace-icon fa fa-home home-icon"></i>
								<a href="#">首页</a>
							</li>

							<li>
								<a href="#">客户管理</a>
							</li>
							<li class="active">客户管理</li>
						</ul><!-- /.breadcrumb -->

						<!-- /section:basics/content.searchbox -->
					</div>

					<!-- /section:basics/content.breadcrumbs -->
					<div class="page-content">

						<!-- /section:settings.box -->
						<div class="page-header">
							<h1>
								客户管理
								<small>
									<i class="ace-icon fa fa-angle-double-right"></i>
								</small>
							</h1>
						</div><!-- /.page-header -->
						
						<div class="row">
							<div class="col-xs-12">
								<form class="form-horizontal" role="form" name="s1" id="s1" action="/uploadImage" method="post" enctype="multipart/form-data">
									<!-- #section:elements.form -->
									<div class="form-group">
										<label class="col-sm-3 control-label no-padding-right" for="form-field-1">上传图片 </label>
										
										<div class="col-sm-6">
											<img id="imageshow"  src="@routes.Assets.at("img/car.jpg")" style="width: 100px;height: 100px;">
										</div>
									</div>
									<div class="form-group">
										<label class="col-sm-3 control-label no-padding-right" for="form-field-1">部门名称 </label>
										
										<div class="col-sm-6">
											<input type="text" id="name" placeholder="部门名称" name="name" class="col-xs-15" />
										</div>
									</div>
									<div class="form-group" >
										<div class="col-sm-6" align="center">
											<div id="uploader" class="wu-example">
											    <div class="queueList">
											        <div id="dndArea" class="placeholder">
											            <div id="filePicker" class="webuploader-container"><div class="webuploader-pick">点击选择图片</div><div id="rt_rt_1a5gb9tqmi4818j0nt114271i9v1" style="position: absolute; top: 0px; left: 448px; width: 168px; height: 44px; overflow: hidden; bottom: auto; right: auto;"><input type="file" name="file" class="webuploader-element-invisible" multiple="multiple" accept="image/*"><label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label></div></div>
											            <p>或将照片拖到这里，单次最多可选4张</p>
											        </div>
											    <ul class="filelist"></ul></div>
											    <div class="statusBar" style="display:none;padding-right: 100px;">
											        <div class="progress" style="display: none;">
											            <span class="text">0%</span>
											            <span class="percentage" style="width: 0%;"></span>
											        </div><div class="info">共0张（0B），已上传0张</div>
											        <div class="btns">
											            <div id="filePicker2" class="webuploader-container"><div class="webuploader-pick">继续添加</div><div id="rt_rt_1a5gb9tr0183t19p2i631gu445a6" style="position: absolute; top: 0px; left: 0px; width: 1px; height: 1px; overflow: hidden;"><input type="file" name="file" class="webuploader-element-invisible" multiple="multiple" accept="image/*"><label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label></div></div><div class="uploadBtn state-pedding">开始上传</div>
											        </div>
											    </div>
											</div>
										</div>
									</div>
									
									<div class="clearfix form-actions">
										<div class="col-md-offset-3 col-md-9">
											<button class="btn btn-info" type="button" id="upload">
												<i class="ace-icon fa fa-check bigger-110"></i>
												提交
											</button>
										</div>
									</div>
								</form>
								<iframe id="uploadframe" name="uploadframe" style="visibility:hidden"></iframe>
								<!--dom结构部分-->
								
								
								
							</div><!-- /.col -->
						</div><!-- /.row -->
					</div><!-- /.page-content -->
				</div>
			</div><!-- /.main-content -->


			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->

		@common.bottomjs()
		
		<!-- the following scripts are used in demo only for onpage help and you don't need them -->
		@common.bottomcss()
<script type="text/javascript">


		
	$("#customergp").addClass("active open");
	$("#ativityMenu").addClass("active");
	
	function setPage(page){
		$('#page2').val(page);
		$('#f2').submit();
	}
	jQuery(function($) {
		//override dialog's title function to allow for HTML titles
		$.widget("ui.dialog", $.extend({}, $.ui.dialog.prototype, {
			_title: function(title) {
				var $title = this.options.title || '&nbsp;'
				if( ("title_html" in this.options) && this.options.title_html == true )
					title.html($title);
				else title.text($title);
			}
		}));

		$("#imageshow").click(function(){
			return $(this).next().click();
		})

		var btn=$("#imageshow");
		var interval;
		var ajaxupload=new AjaxUpload(btn,
			{
			action:"/uploadImage",
			type:"POST",
			name:"myfile",
			autoSubmit: false, //设置不自动上传
			onComplete:function(file, response){
				alert(response);
			}
			});

		$("#upload").click(function() {
			ajaxupload.submit(); //触发上传
        })

     
				               
	});

	function setDetailId(id){
		window.location.href='/{ativityMenu}Detailed/'+id;
	}
	function setEditId(id){
	
		window.location.href='/{ativityMenu}Edit/'+id;
	}
	function redirectto(url){
		window.location.href=url;
	}
	function setDelId(id){
	
			$( "#dialog-confirm" ).removeClass('hide').dialog({
				resizable: false,
				width: '320',
				modal: true,
				title: "<div class='widget-header'><h4 class='smaller'><i class='ace-icon fa fa-exclamation-triangle red'></i> 温馨提示:</h4></div>",
				title_html: true,
				buttons: [
					{
						html: "<i class='ace-icon fa fa-trash-o bigger-110'></i>&nbsp; 确定",
						"class" : "btn btn-danger btn-minier",
						click: function() {
							window.location.href='/{ativityMenu}Del/'+id;
						}
					}
					,
					{
						html: "<i class='ace-icon fa fa-times bigger-110'></i>&nbsp; 取消",
						"class" : "btn btn-minier",
						click: function() {
							$( this ).dialog( "close" );
						}
					}
				]
			});
}

	jQuery(function() {
	    var $ = jQuery,    // just in case. Make sure it's not an other libaray.

	        $wrap = $('#uploader'),

	        // 图片容器
	        $queue = $('<ul class="filelist"></ul>')
	            .appendTo( $wrap.find('.queueList') ),

	        // 状态栏，包括进度和控制按钮
	        $statusBar = $wrap.find('.statusBar'),

	        // 文件总体选择信息。
	        $info = $statusBar.find('.info'),

	        // 上传按钮
	        $upload = $wrap.find('.uploadBtn'),

	        // 没选择文件之前的内容。
	        $placeHolder = $wrap.find('.placeholder'),

	        // 总体进度条
	        $progress = $statusBar.find('.progress').hide(),

	        // 添加的文件数量
	        fileCount = 0,

	        // 添加的文件总大小
	        fileSize = 0,

	        // 优化retina, 在retina下这个值是2
	        ratio = window.devicePixelRatio || 1,

	        // 缩略图大小
	        thumbnailWidth = 110 * ratio,
	        thumbnailHeight = 110 * ratio,

	        // 可能有pedding, ready, uploading, confirm, done.
	        state = 'pedding',

	        // 所有文件的进度信息，key为file id
	        percentages = {},

	        supportTransition = (function(){
	            var s = document.createElement('p').style,
	                r = 'transition' in s ||
	                      'WebkitTransition' in s ||
	                      'MozTransition' in s ||
	                      'msTransition' in s ||
	                      'OTransition' in s;
	            s = null;
	            return r;
	        })(),

	        // WebUploader实例
	        uploader;

	    if ( !WebUploader.Uploader.support() ) {
	        alert( 'Web Uploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器');
	        throw new Error( 'WebUploader does not support the browser you are using.' );
	    }

	    // 实例化
	    uploader = WebUploader.create({
	        pick: {
	            id: '#filePicker',
	            label: '点击选择图片'
	        },
	        dnd: '#uploader .queueList',
	        paste: document.body,

	        accept: {
	            title: 'Images',
	            extensions: 'gif,jpg,jpeg,bmp,png',
	            mimeTypes: 'image/*'
	        },

	        // swf文件路径
	        swf: 'Uploader.swf',

	        disableGlobalDnd: true,

	        chunked: true,
	        server: '/uploadImage',
	        fileNumLimit: 4,
	        fileSizeLimit: 5 * 1024 * 1024 * 1024,    // 200 M
	        fileSingleSizeLimit: 1 * 1024 * 1024 * 1024    // 50 M
	    });

	    // 添加“添加文件”的按钮，
	    uploader.addButton({
	        id: '#filePicker2',
	        label: '继续添加'
	    });

	    // 当有文件添加进来时执行，负责view的创建
	    function addFile( file ) {
	        var $li = $( '<li id="' + file.id + '">' +
	                '<p class="title">' + file.name + '</p>' +
	                '<p class="imgWrap"></p>'+
	                '<p class="progress"><span></span></p>' +
	                '</li>' ),

	            $btns = $('<div class="file-panel">' +
	                '<span class="cancel">删除</span>' +
	                '<span class="rotateRight">向右旋转</span>' +
	                '<span class="rotateLeft">向左旋转</span></div>').appendTo( $li ),
	            $prgress = $li.find('p.progress span'),
	            $wrap = $li.find( 'p.imgWrap' ),
	            $info = $('<p class="error"></p>'),

	            showError = function( code ) {
	                switch( code ) {
	                    case 'exceed_size':
	                        text = '文件大小超出';
	                        break;

	                    case 'interrupt':
	                        text = '上传暂停';
	                        break;

	                    default:
	                        text = '上传失败，请重试';
	                        break;
	                }

	                $info.text( text ).appendTo( $li );
	            };

	        if ( file.getStatus() === 'invalid' ) {
	            showError( file.statusText );
	        } else {
	            // todo lazyload
	            $wrap.text( '预览中' );
	            uploader.makeThumb( file, function( error, src ) {
	                if ( error ) {
	                    $wrap.text( '不能预览' );
	                    return;
	                }

	                var img = $('<img src="'+src+'">');
	                $wrap.empty().append( img );
	            }, thumbnailWidth, thumbnailHeight );

	            percentages[ file.id ] = [ file.size, 0 ];
	            file.rotation = 0;
	        }

	        file.on('statuschange', function( cur, prev ) {
	            if ( prev === 'progress' ) {
	                $prgress.hide().width(0);
	            } else if ( prev === 'queued' ) {
	                $li.off( 'mouseenter mouseleave' );
	                $btns.remove();
	            }

	            // 成功
	            if ( cur === 'error' || cur === 'invalid' ) {
	                console.log( file.statusText );
	                showError( file.statusText );
	                percentages[ file.id ][ 1 ] = 1;
	            } else if ( cur === 'interrupt' ) {
	                showError( 'interrupt' );
	            } else if ( cur === 'queued' ) {
	                percentages[ file.id ][ 1 ] = 0;
	            } else if ( cur === 'progress' ) {
	                $info.remove();
	                $prgress.css('display', 'block');
	            } else if ( cur === 'complete' ) {
	                $li.append( '<span class="success"></span>' );
	            }

	            $li.removeClass( 'state-' + prev ).addClass( 'state-' + cur );
	        });

	        $li.on( 'mouseenter', function() {
	            $btns.stop().animate({height: 30});
	        });

	        $li.on( 'mouseleave', function() {
	            $btns.stop().animate({height: 0});
	        });

	        $btns.on( 'click', 'span', function() {
	            var index = $(this).index(),
	                deg;

	            switch ( index ) {
	                case 0:
	                    uploader.removeFile( file );
	                    return;

	                case 1:
	                    file.rotation += 90;
	                    break;

	                case 2:
	                    file.rotation -= 90;
	                    break;
	            }

	            if ( supportTransition ) {
	                deg = 'rotate(' + file.rotation + 'deg)';
	                $wrap.css({
	                    '-webkit-transform': deg,
	                    '-mos-transform': deg,
	                    '-o-transform': deg,
	                    'transform': deg
	                });
	            } else {
	                $wrap.css( 'filter', 'progid:DXImageTransform.Microsoft.BasicImage(rotation='+ (~~((file.rotation/90)%4 + 4)%4) +')');
	               
	            }


	        });

	        $li.appendTo( $queue );
	    }

	    // 负责view的销毁
	    function removeFile( file ) {
	        var $li = $('#'+file.id);

	        delete percentages[ file.id ];
	        updateTotalProgress();
	        $li.off().find('.file-panel').off().end().remove();
	    }

	    function updateTotalProgress() {
	        var loaded = 0,
	            total = 0,
	            spans = $progress.children(),
	            percent;

	        $.each( percentages, function( k, v ) {
	            total += v[ 0 ];
	            loaded += v[ 0 ] * v[ 1 ];
	        } );

	        percent = total ? loaded / total : 0;

	        spans.eq( 0 ).text( Math.round( percent * 100 ) + '%' );
	        spans.eq( 1 ).css( 'width', Math.round( percent * 100 ) + '%' );
	        updateStatus();
	    }

	    function updateStatus() {
	        var text = '', stats;

	        if ( state === 'ready' ) {
	            text = '选中' + fileCount + '张图片，共' +
	                    WebUploader.formatSize( fileSize ) + '。';
	        } else if ( state === 'confirm' ) {
	            stats = uploader.getStats();
	            if ( stats.uploadFailNum ) {
	                text = '已成功上传' + stats.successNum+ '张照片至XX相册，'+
	                    stats.uploadFailNum + '张照片上传失败，<a class="retry" href="#">重新上传</a>失败图片或<a class="ignore" href="#">忽略</a>'
	            }

	        } else {
	            stats = uploader.getStats();
	            text = '共' + fileCount + '张（' +
	                    WebUploader.formatSize( fileSize )  +
	                    '），已上传' + stats.successNum + '张';

	            if ( stats.uploadFailNum ) {
	                text += '，失败' + stats.uploadFailNum + '张';
	            }
	        }

	        $info.html( text );
	    }

	    function setState( val ) {
	        var file, stats;

	        if ( val === state ) {
	            return;
	        }

	        $upload.removeClass( 'state-' + state );
	        $upload.addClass( 'state-' + val );
	        state = val;

	        switch ( state ) {
	            case 'pedding':
	                $placeHolder.removeClass( 'element-invisible' );
	                $queue.parent().removeClass('filled');
	                $queue.hide();
	                $statusBar.addClass( 'element-invisible' );
	                uploader.refresh();
	                break;

	            case 'ready':
	                $placeHolder.addClass( 'element-invisible' );
	                $( '#filePicker2' ).removeClass( 'element-invisible');
	                $queue.parent().addClass('filled');
	                $queue.show();
	                $statusBar.removeClass('element-invisible');
	                uploader.refresh();
	                break;

	            case 'uploading':
	                $( '#filePicker2' ).addClass( 'element-invisible' );
	                $progress.show();
	                $upload.text( '暂停上传' );
	                break;

	            case 'paused':
	                $progress.show();
	                $upload.text( '继续上传' );
	                break;

	            case 'confirm':
	                $progress.hide();
	                //$upload.text( '开始上传' ).addClass( 'disabled' );
	                $upload.text( '开始上传' ).hide();

	                stats = uploader.getStats();
	                if ( stats.successNum && !stats.uploadFailNum ) {
	                    setState( 'finish' );
	                    return;
	                }
	                break;
	            case 'finish':
	                stats = uploader.getStats();
	                if ( stats.successNum ) {
	                    alert( '上传成功' );
	                } else {
	                    // 没有成功的图片，重设
	                    state = 'done';
	                    location.reload();
	                }
	                break;
	        }

	        updateStatus();
	    }

	    uploader.onUploadProgress = function( file, percentage ) {
	        var $li = $('#'+file.id),
	            $percent = $li.find('.progress span');

	        $percent.css( 'width', percentage * 100 + '%' );
	        percentages[ file.id ][ 1 ] = percentage;
	        updateTotalProgress();
	    };

	    uploader.onFileQueued = function( file ) {
	        fileCount++;
	        fileSize += file.size;

	        if ( fileCount === 1 ) {
	            $placeHolder.addClass( 'element-invisible' );
	            $statusBar.show();
	        }

	        addFile( file );
	        setState( 'ready' );
	        updateTotalProgress();
	    };

	    uploader.onFileDequeued = function( file ) {
	        fileCount--;
	        fileSize -= file.size;

	        if ( !fileCount ) {
	            setState( 'pedding' );
	        }

	        removeFile( file );
	        updateTotalProgress();

	    };

	    uploader.on( 'all', function( type ) {
	        var stats;
	        switch( type ) {
	            case 'uploadFinished':
	                setState( 'confirm' );
	                break;

	            case 'startUpload':
	                setState( 'uploading' );
	                break;

	            case 'stopUpload':
	                setState( 'paused' );
	                break;

	        }
	    });

	    uploader.onError = function( code ) {
		    console.log(code);
	        alert( 'Eroor: ' + code );
	    };

	    $upload.on('click', function() {
	        if ( $(this).hasClass( 'disabled' ) ) {
	            return false;
	        }

	        if ( state === 'ready' ) {
	            uploader.upload();
	        } else if ( state === 'paused' ) {
	            uploader.upload();
	        } else if ( state === 'uploading' ) {
	            uploader.stop();
	        }
	    });

	    $info.on( 'click', '.retry', function() {
	        uploader.retry();
	    } );

	    $info.on( 'click', '.ignore', function() {
	        alert( 'todo' );
	    } );

	    $upload.addClass( 'state-' + state );
	    updateTotalProgress();
	});
</script>

							
<div id="dialog-confirm" class="hide">
<div class="alert alert-info bigger-110">
			删除数据后将不能恢复。
</div>

<div class="space-6"></div>

		<p class="bigger-110 bolder center grey">
				<i class="ace-icon fa fa-hand-o-right blue bigger-120"></i>
						您确定要删除该数据吗?
		</p>
</div><!-- #dialog-confirm -->
</div>

	</body>
</html>
